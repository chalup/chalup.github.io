
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Porcupine Programmer</title>
  <meta name="author" content="Jerzy Chalupski">

  
  <meta name="description" content="I have another gotcha for you. Can you tell what&rsquo;s wrong with the following code? 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chalup.github.io/blog/page/6">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Porcupine Programmer" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-51611487-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Porcupine Programmer</a></h1>
  
    <h2>Programming rants, random stuff and some more programming.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:chalup.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/09/05/android-sharedpreferences-gotcha/">Android SharedPreferences Gotcha</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-09-05T22:26:00+02:00" pubdate data-updated="true">Sep 5<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/09/05/android-sharedpreferences-gotcha/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/09/05/android-sharedpreferences-gotcha/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have another gotcha for you. Can you tell what&rsquo;s wrong with the following code?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFragment</span> <span class="kd">extends</span> <span class="n">Fragment</span> <span class="kd">implements</span> <span class="n">OnSharedPreferenceChangeListener</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">TextView</span> <span class="n">mInfo</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">SharedPreferences</span> <span class="n">mPreferences</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">INFO_SP_KEY</span> <span class="o">=</span> <span class="s">&quot;info&quot;</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">View</span> <span class="nf">onCreateView</span><span class="o">(</span><span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="o">,</span> <span class="n">ViewGroup</span> <span class="n">container</span><span class="o">,</span>
</span><span class='line'>      <span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">inflater</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">my_fragment</span><span class="o">,</span> <span class="n">container</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onViewCreated</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">,</span> <span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onViewCreated</span><span class="o">(</span><span class="n">view</span><span class="o">,</span> <span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>    <span class="n">mInfo</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">view</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">info</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSharedPreferenceChanged</span><span class="o">(</span><span class="n">SharedPreferences</span> <span class="n">sharedPreferences</span><span class="o">,</span> <span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">INFO_SP_KEY</span><span class="o">))</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">updateInfo</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onActivityCreated</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onActivityCreated</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
</span><span class='line'>    <span class="n">mPreferences</span> <span class="o">=</span> <span class="n">PreferenceManager</span><span class="o">.</span><span class="na">getDefaultSharedPreferences</span><span class="o">(</span><span class="n">getActivity</span><span class="o">());</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onPause</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onPause</span><span class="o">();</span>
</span><span class='line'>    <span class="n">mPreferences</span><span class="o">.</span><span class="na">unregisterOnSharedPreferenceChangeListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResume</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">.</span><span class="na">onResume</span><span class="o">();</span>
</span><span class='line'>    <span class="n">mPreferences</span><span class="o">.</span><span class="na">registerOnSharedPreferenceChangeListener</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</span><span class='line'>    <span class="n">updateInfo</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">updateInfo</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">mInfo</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">getString</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">info_text</span><span class="o">,</span> <span class="n">mPreferences</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="n">INFO_SP_KEY</span><span class="o">,</span> <span class="mi">0</span><span class="o">)));</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>At first glance everything looks fine and in most cases it will work fine as well. However, if you a) set android:minSdkVersion to 8 or lower and b) change the shared preference from another thread (IntentService, SyncAdapter, etc.), you&rsquo;ll get the following crash:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">ViewRoot</span><span class="n">$CalledFromWrongThreadException</span><span class="o">:</span> <span class="n">Only</span> <span class="n">the</span> <span class="n">original</span> <span class="n">thread</span> <span class="n">that</span> <span class="n">created</span> <span class="n">a</span> <span class="n">view</span> <span class="n">hierarchy</span> <span class="n">can</span> <span class="n">touch</span> <span class="n">its</span> <span class="n">views</span><span class="o">.</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">ViewRoot</span><span class="o">.</span><span class="na">checkThread</span><span class="o">(</span><span class="n">ViewRoot</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2802</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">ViewRoot</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">ViewRoot</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">594</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">View</span><span class="o">.</span><span class="na">requestLayout</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">8125</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">TextView</span><span class="o">.</span><span class="na">checkForRelayout</span><span class="o">(</span><span class="n">TextView</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">5378</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">TextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">TextView</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2688</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">TextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">TextView</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2556</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">widget</span><span class="o">.</span><span class="na">TextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">TextView</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2531</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="na">porcupineprogrammer</span><span class="o">.</span><span class="na">sharedpreferencesgotcha</span><span class="o">.</span><span class="na">BaseFragment</span><span class="o">.</span><span class="na">updateButtonText</span><span class="o">(</span><span class="n">BaseFragment</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">65</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="na">porcupineprogrammer</span><span class="o">.</span><span class="na">sharedpreferencesgotcha</span><span class="o">.</span><span class="na">WrongFragment</span><span class="o">.</span><span class="na">onSharedPreferenceChanged</span><span class="o">(</span><span class="n">WrongFragment</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">12</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">android</span><span class="o">.</span><span class="na">app</span><span class="o">.</span><span class="na">ContextImpl</span><span class="n">$SharedPreferencesImpl$EditorImpl</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">ContextImpl</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">2830</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">com</span><span class="o">.</span><span class="na">porcupineprogrammer</span><span class="o">.</span><span class="na">sharedpreferencesgotcha</span><span class="o">.</span><span class="na">BaseFragment</span><span class="n">$1$1</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">BaseFragment</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">36</span><span class="o">)</span>
</span><span class='line'><span class="mi">09</span><span class="o">-</span><span class="mi">05</span> <span class="mi">07</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">58.993</span><span class="o">:</span> <span class="n">E</span><span class="o">/</span><span class="n">AndroidRuntime</span><span class="o">(</span><span class="mi">403</span><span class="o">):</span> <span class="n">at</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Thread</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">java</span><span class="o">:</span><span class="mi">1096</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Fortunately the obvious crashlog is obvious and you can solve this issue in about 5 seconds, by wrapping the UI action in <code>Activity.runOnUiThread()</code> method. Morbidly curious may track the root cause of this issue in <a href="http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/ContextImpl.java/?v=diff&amp;id2=2.3_r1#3035">GrepCode</a>. <strong>Tl;dr</strong>: before Gingerbread the listeners are notified in the same thread as the <code>SharedPreferences.commit()</code> caller, in later releases <code>commit()</code> ensures the notifications are performed in UI thread.</p>

<p>Code of the sample application that demonstrates this issue is <a href="https://github.com/chalup/blog-sharedpreferences-gotcha">available on my github</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/30/custom-scrollbar-graphics-in-android/">Custom Scrollbar Graphics in Android</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-30T16:04:00+02:00" pubdate data-updated="true">Aug 30<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/08/30/custom-scrollbar-graphics-in-android/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/08/30/custom-scrollbar-graphics-in-android/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of the UI elements you might want to customize in your app are scrollbars for ListViews, ScrollViews and other scrollable objects. It&rsquo;s a minor visual change, but it might give your app more consistent and polished look and feel, especially in case of the heavily branded UI.</p>

<p>Anyways, changing the default scrollbar style is dead simple &ndash; you just need to specify new drawables for the track and thumb in your style:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;style</span> <span class="na">name=</span><span class="s">&quot;badList&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarThumbVertical&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_handle<span class="nt">&lt;/item&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarTrackVertical&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_track<span class="nt">&lt;/item&gt;</span>
</span><span class='line'><span class="nt">&lt;/style&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Of course, there is a small gotcha (why else would I bother to write this blog post?). Let&rsquo;s say that you don&rsquo;t need to customize horizontal scrollbar, so you prepare only vertical 9-patches:</p>

<p><img class="center" src="/images/zoom_vertical.png"></p>

<p>On Ice Cream Sandwich everything looks fine, but on Gingerbread the graphics are not exactly what you want:</p>

<p><img class="center" src="/images/badstyle.png"></p>

<p>Quick <a href="https://www.google.pl/search?q=android+incorrect+custom+scrollbar+width">Google search</a> returned a <a href="http://stackoverflow.com/questions/3736768/android-scrollview-scrollbarsize">StackOverflow thread</a> with a description and link to <a href="http://code.google.com/p/android/issues/detail?id=14317">Android bug tracker</a>, but no full workaround. If you&rsquo;re too lazy to click on those links, on Gingerbread and earlier releases the View asks ScrollbarDrawable for the height of horizontal scrollbar and uses it as a horizontal scrollbar height and vertical scrollbar width. Let&rsquo;s modify our scrollbar graphics a bit:</p>

<p><img class="center" src="/images/zoomed_symmetric.png"></p>

<p>And apply it as both horizontal and vertical scrollbar.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;style</span> <span class="na">name=</span><span class="s">&quot;goodList&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarThumbVertical&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_handle<span class="nt">&lt;/item&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarTrackVertical&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_track<span class="nt">&lt;/item&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarThumbHorizontal&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_handle<span class="nt">&lt;/item&gt;</span>
</span><span class='line'>    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">&quot;android:scrollbarTrackHorizontal&quot;</span><span class="nt">&gt;</span>@drawable/scrollbar_track<span class="nt">&lt;/item&gt;</span>
</span><span class='line'><span class="nt">&lt;/style&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lo and behold, it works!</p>

<p><img class="center" src="/images/goodstyle.png"></p>

<p>Note: in general case you probably want to create another graphics for horizontal scrollbar by rotating and flipping vertical scrollbar graphics. Our scrollbar graphics doesn&rsquo;t have any non-symmetric elements and I&rsquo;m lazy, so I used the same 9-patch for both scrollbars.</p>

<p>The code of the sample application can be found <a href="https://github.com/chalup/blog-scrollbargotcha">here</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/08/24/more-content-coming-soon/">More Content Coming Soon</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-24T23:39:00+02:00" pubdate data-updated="true">Aug 24<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/08/24/more-content-coming-soon/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/08/24/more-content-coming-soon/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It&rsquo;s been a while since my last blog post. The main reason of this unfortunate state is the fact that I&rsquo;ve changed my day job. I&rsquo;ve dumped my cushy corporate post in favor of more demanding position at startup. I have much less time for blogging and my personal projects, but in return I&rsquo;ve learned a <strong>lot</strong> about Android. I already have about two dozens entries on my topic list and I keep adding new ones every other day.</p>

<p>The &ldquo;write when you have some time&rdquo; plan obviously doesn&rsquo;t work, so I have to try something else. My current plan is &ldquo;publish one post every Wednesday&rdquo;. We&rsquo;ll see soon how will it work out for me.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/06/22/sqlite-unions-gotcha/">SQLite Unions Gotcha</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-22T23:03:00+02:00" pubdate data-updated="true">Jun 22<span>nd</span>, 2012</time>
        
           | <a href="/blog/2012/06/22/sqlite-unions-gotcha/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/06/22/sqlite-unions-gotcha/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I&rsquo;ve been tracking the problem with SQLite database used in the Android application I&rsquo;m working on. The starting point of the whole story is that I&rsquo;ve noticed that the cursor created with the <code>SQLiteDatabase.query()</code> method returned smaller data set than the same query executed through sqlite3 command line interface. The query in question looked like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">some_view</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">column_a</span><span class="o">=</span><span class="mi">1</span> <span class="k">OR</span> <span class="n">column_b</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Inside the Android app I was getting rows for the second part of OR clause (i.e. <code>column_b=1</code>), but no rows for the first part.</p>

<p>Quick search through Android sources yielded the clue &ndash; I wasn&rsquo;t executing exactly the same query on the command line. Selection arguments are always bound as a strings, so the question marks in query string should be surrounded with quotes. So the Android app was executing the following query:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">some_view</span> <span class="k">WHERE</span> <span class="p">(</span><span class="n">column_a</span><span class="o">=</span><span class="ss">&quot;1&quot;</span> <span class="k">OR</span> <span class="n">column_b</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now we have another puzzle: why <code>column_b=1</code> and <code>column_b="1"</code> give the same results, but the behavior is different for <code>column_a</code>? Let&rsquo;s try to reproduce the problem:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="p">.</span><span class="k">mode</span> <span class="k">column</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="p">.</span><span class="n">headers</span> <span class="k">on</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">t</span> <span class="p">(</span><span class="n">x</span> <span class="nb">INTEGER</span><span class="p">);</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">t</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">t</span> <span class="k">WHERE</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">t</span> <span class="k">WHERE</span> <span class="n">x</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">;</span>
</span><span class='line'><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>So far so good, no surprises. Let&rsquo;s create a view similar to the one which causes problems.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">v</span> <span class="k">AS</span> <span class="k">SELECT</span> <span class="k">NULL</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span> <span class="k">AS</span> <span class="n">b</span> <span class="k">FROM</span> <span class="n">t</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">x</span><span class="p">,</span> <span class="k">NULL</span> <span class="k">FROM</span> <span class="n">t</span><span class="p">;</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">v</span><span class="p">;</span>
</span><span class='line'><span class="n">a</span>           <span class="n">b</span>
</span><span class='line'><span class="c1">----------  ----------</span>
</span><span class='line'>            <span class="mi">1</span>
</span><span class='line'><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now let&rsquo;s take a look at counts:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">v</span> <span class="k">WHERE</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">v</span> <span class="k">WHERE</span> <span class="n">b</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">v</span> <span class="k">WHERE</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">v</span> <span class="k">WHERE</span> <span class="n">a</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>Yay, we reproduced our bug. But why is this happening?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="n">PRAGMA</span> <span class="n">TABLE_INFO</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span><span class='line'><span class="n">cid</span>         <span class="n">name</span>        <span class="k">type</span>        <span class="k">notnull</span>     <span class="n">dflt_value</span>  <span class="n">pk</span>
</span><span class='line'><span class="c1">----------  ----------  ----------  ----------  ----------  ----------</span>
</span><span class='line'><span class="mi">0</span>           <span class="n">a</span>                       <span class="mi">0</span>                       <span class="mi">0</span>
</span><span class='line'><span class="mi">1</span>           <span class="n">b</span>           <span class="nb">integer</span>     <span class="mi">0</span>                       <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>It seems that the lack of explicitly defined type of the first column prevents type conversion (please note that this is only my assumption based on the observations above; unfortunately the sqlite documentation doesn&rsquo;t cover such cases in detail). How can we work around this issue?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">vfix</span> <span class="k">AS</span> <span class="k">SELECT</span> <span class="n">x</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span> <span class="k">AS</span> <span class="n">b</span> <span class="k">FROM</span> <span class="n">t</span> <span class="k">WHERE</span> <span class="mi">1</span><span class="o">=</span><span class="mi">0</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">v</span><span class="p">;</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="n">PRAGMA</span> <span class="n">TABLE_INFO</span><span class="p">(</span><span class="n">vfix</span><span class="p">);</span>
</span><span class='line'><span class="n">cid</span>         <span class="n">name</span>        <span class="k">type</span>        <span class="k">notnull</span>     <span class="n">dflt_value</span>  <span class="n">pk</span>
</span><span class='line'><span class="c1">----------  ----------  ----------  ----------  ----------  ----------</span>
</span><span class='line'><span class="mi">0</span>           <span class="n">a</span>           <span class="nb">integer</span>     <span class="mi">0</span>                       <span class="mi">0</span>
</span><span class='line'><span class="mi">1</span>           <span class="n">b</span>           <span class="nb">integer</span>     <span class="mi">0</span>                       <span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see the column types are correctly copied from the underlying table. Let&rsquo;s check the counts:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">vfix</span> <span class="k">WHERE</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">vfix</span> <span class="k">WHERE</span> <span class="n">b</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">vfix</span> <span class="k">WHERE</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="n">sqlite</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">vfix</span> <span class="k">WHERE</span> <span class="n">a</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
</span><span class='line'><span class="c1">----------</span>
</span><span class='line'><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>Looks OK. Pretty? No, but it does the job and that&rsquo;s what matters at the end of the day.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/30/qml-applications-on-nokia-belle/">QML Applications on Nokia Belle</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-30T20:06:00+02:00" pubdate data-updated="true">May 30<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/05/30/qml-applications-on-nokia-belle/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/05/30/qml-applications-on-nokia-belle/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After the latest update of &ldquo;Nu, Pogodi!&rdquo;, I received few negative reviews saying that the game doesn&rsquo;t work. I&rsquo;ve tested the game thoroughly on all devices I was able to get my hands on, but I wasn&rsquo;t able to reproduce the error, so I decided to wait until I get more info. Few days ago with the help of one customer I was able to pin down the problem &ndash; the game failed to display any UI on new Belle firmware with Qt 4.8.0. I don&rsquo;t have such device myself, but fortunately the great <a href="http://www.developer.nokia.com/Devices/Remote_device_access/">Remote Device Access</a> service allows testing on Nokia 808 PureView with latest Belle firmware. I&rsquo;ve reproduced the error, wrote the Nokia Developers Support, and they sent me a very helpful link: <a href="http://www.developer.nokia.com/Community/Wiki/Changes_in_Symbian_Belle_and_Qt_4.7.4#Changes_in_Nokia_Belle_FP1">Changes in Nokia Belle FP1</a>. One issue listed there caught my eye:</p>

<blockquote><p>If application does not specify a size for the root QML object and doesn’t use the Qt components Window as root element (Window component should not be used as a child item), it might cause the root window not to be shown.</p><p><b>Solution / Workaround:</b><br/>Always declare a size for your custom QML root element.</p></blockquote>


<p>I&rsquo;ve checked my main QML file and indeed, I did not set the root element size, instead I&rsquo;ve set the resize mode to SizeRootObjectToView and maximized the QDeclarativeView. I think it&rsquo;s the better solution than setting the root element size explicitly, because the display resolution is not the same on all Nokia phones (I&rsquo;m looking at you, E6). Instead of doing that, I wrapped my entire UI into Window element from Qt Components and lo and behold, my game displayed something, although it wasn&rsquo;t exactly what I expected:</p>

<p><img class="center" src="/images/Nokia+808+PureView.png"></p>

<p>My code locked the screen orientation after loading main QML file, and it looked like the only thing that might cause this problem, so I changed the calls order. On Belle FP1 devices everything worked fine, but this change broke the display on devices with Anna and older Belle firmware:</p>

<p><img class="center" src="/images/Nokia+N8-00.png"></p>

<p>Wat? The only solution I came up with was creating the utility method for detecting version of Qt during runtime and locking screen orientation after and before loading main QML file, depending on the Qt version. Relevant piece of code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='c++'><span class='line'><span class="kt">bool</span> <span class="n">Utils</span><span class="o">::</span><span class="n">runtimeQtAtLeast</span><span class="p">(</span><span class="kt">int</span> <span class="n">major</span><span class="p">,</span> <span class="kt">int</span> <span class="n">minor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bugfix</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">const</span> <span class="n">QStringList</span> <span class="n">v</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii</span><span class="p">(</span><span class="n">qVersion</span><span class="p">()).</span><span class="n">split</span><span class="p">(</span><span class="n">QLatin1Char</span><span class="p">(</span><span class="sc">&#39;.&#39;</span><span class="p">));</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">runtimeVersion</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">toInt</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">v</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">toInt</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">v</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">toInt</span><span class="p">();</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">version</span> <span class="o">=</span> <span class="n">major</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="n">minor</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">bugfix</span><span class="p">;</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">version</span> <span class="o">&lt;=</span> <span class="n">runtimeVersion</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ...</span>
</span><span class='line'>
</span><span class='line'><span class="k">const</span> <span class="kt">bool</span> <span class="n">qt48</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">::</span><span class="n">runtimeQtAtLeast</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="n">QmlApplicationViewer</span> <span class="n">viewer</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">qt48</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">viewer</span><span class="p">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QmlApplicationViewer</span><span class="o">::</span><span class="n">ScreenOrientationLockLandscape</span><span class="p">);</span>
</span><span class='line'>    <span class="n">viewer</span><span class="p">.</span><span class="n">setResizeMode</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">SizeRootObjectToView</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">viewer</span><span class="p">.</span><span class="n">setMainQmlFile</span><span class="p">(</span><span class="n">QLatin1String</span><span class="p">(</span><span class="s">&quot;qml/nupagadi/GameArea.qml&quot;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">qt48</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">viewer</span><span class="p">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QmlApplicationViewer</span><span class="o">::</span><span class="n">ScreenOrientationLockLandscape</span><span class="p">);</span>
</span><span class='line'>    <span class="n">viewer</span><span class="p">.</span><span class="n">setResizeMode</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">SizeRootObjectToView</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This kind of incompatibility between <strong>minor</strong> versions of the Qt framework is mind boggling. It makes me think what else did Nokia screw up in Qt 4.8.0 for Symbian and what will they screw up in the next firmware updates. One thing is sure: I&rsquo;ll have a lot of blogging material.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/17/git-killer-feature-content-tracking/">Git Killer Feature: Content Tracking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-17T16:20:00+02:00" pubdate data-updated="true">Apr 17<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/04/17/git-killer-feature-content-tracking/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/04/17/git-killer-feature-content-tracking/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>At my current day job I was the first adopter of git and one of the most frequently question I&rsquo;m asked as &ldquo;the git guy&rdquo; is the variation of &ldquo;why do you use git instead of mercurial?&rdquo;. I usually responded that git was the first distributed VCS I used, and I played for a while with hg and bazaar, but I haven&rsquo;t discovered any significant feature that would make me change my initial choice. Today I have found the case that allows me to give a better answer.</p>

<p>About a month ago I released the <a href="https://play.google.com/store/apps/details?id=com.chalup.WordJudgeEN">Word Judge</a> application &ndash; an offline word validator for Scrabble and other word games. Initially I was working only on one version of Word Judge with polish dictionary, so I had one line of code in my git repository:</p>

<p><img class="center" src="/images/1.png"></p>

<p>When polish version was ready, I decided that I might as well release the english version, because it would require only minor changes: changing app icon and dictionary file. It turned out that I also have to change the application package, so both versions of Word Judge could be installed at the same time. The changes were in fact minor, but included a lot of renaming (package name is mirrored by the directory structure):</p>

<p><img class="center" src="/images/2.png"></p>

<p>Later on I decided to add ads to my application. First, I&rsquo;ve added the necessary code to master (i.e. polish) branch:</p>

<p><img class="center" src="/images/3.png"></p>

<p>I switched to english branch, typed <code>git merge master --no-commit</code>, and was very surprised to see just a few conflicts in binary files (icons). All the changes made in java code, <strong>in the renamed files</strong>, were automatically merged. If you still don&rsquo;t get how awesome this is, consider what would I had to do without it:</p>

<ol>
<li>Start the merge</li>
<li>Resolve the conflict by selecting &ldquo;keep deleted files&rdquo; for every java file changed in the master branch</li>
<li>Manually merge every java file from &ldquo;pl&rdquo; package and &ldquo;en&rdquo; package</li>
<li>Delete &ldquo;pl&rdquo; package</li>
<li>Commit changes</li>
</ol>


<p>And I would have to do this <strong>every single time</strong> I port the changes between language branches. It&rsquo;s a tedious and error-prone job, and git automatically (automagically?) does it for me. How cool is that? Mightily cool IMHO. Of course if I add some java files in one branch, I have to do move them to correct package in the other branch (hence the <code>--no-commit</code> switch in git command above), but most of the conflicts are caused by binary files.</p>

<p>It&rsquo;s also more common case than you might think, i.e. you don&rsquo;t have to write a dictionary supporting multiple languages to run into it. For example if you have a lite and full version of an app, you have exactly the same situation.</p>

<p>Right now my repository looks like this (or it would look like this if the git gui tools didn&rsquo;t suck, but that&rsquo;s another story):</p>

<p><img class="center" src="/images/4.png"></p>

<p>I can&rsquo;t imagine supporting such structure without automatic merges provided by git, because it tracks <strong>content</strong> instead of <strong>files</strong>. And that&rsquo;s the real killer feature that distinguishes git from other DVCS.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/10/dark-side-of-linq-linq-to-sql-on/">The Dark Side of LINQ: LINQ to SQL on Windows Phone</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-10T08:23:00+02:00" pubdate data-updated="true">Apr 10<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/04/10/dark-side-of-linq-linq-to-sql-on/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/04/10/dark-side-of-linq-linq-to-sql-on/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In case you don&rsquo;t know what&rsquo;s LINQ and you use C#, I suggest you drop everything you do and enlighten yourself. Be warned: when you learn LINQ, you won&rsquo;t be able to work with Java collections (Guava makes them bearable, but barely) or Qt/STL containers without throwing in your mouth every now and then.</p>

<p>Here&rsquo;s tl;dr for the non-enlightened: LINQ is a sane way to query and alter the data. Instead of this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">PrintSortedEvenNumbers</span><span class="p">(</span><span class="n">IList</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">unfiltered</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">filtered</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
</span><span class='line'>    <span class="k">foreach</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="k">in</span> <span class="n">unfiltered</span><span class="p">)</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'>            <span class="n">filtered</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span class='line'>    <span class="n">filtered</span><span class="p">.</span><span class="n">Sort</span><span class="p">();</span>
</span><span class='line'>    <span class="k">foreach</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="k">in</span> <span class="n">filtered</span><span class="p">)</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">i</span> <span class="p">+</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can just write this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">PrintSortedEvenNumbers</span><span class="p">(</span><span class="n">IList</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">unfiltered</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">foreach</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="k">in</span> <span class="n">unfiltered</span><span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">num</span> <span class="p">=&gt;</span> <span class="n">num</span> <span class="p">%</span> <span class="m">2</span> <span class="p">==</span> <span class="m">0</span><span class="p">).</span><span class="n">OrderBy</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span><span class="p">))</span>
</span><span class='line'>        <span class="n">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">i</span> <span class="p">+</span> <span class="s">&quot; &quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is a trivial example, but the more complicated code, the more benefit you get from using LINQ.</p>

<p>I started using it for operations on collections and XML files and I immediately fell in love with it. Imagine my joy when I learned that Windows Phone 7.1 finally supports local relational database which can be queried through LINQ to SQL!</p>

<p>I&rsquo;ve read the <a href="http://msdn.microsoft.com/en-us/library/hh286405(v=vs.92">tutorial</a>.aspx), thought a bit about the application I was writing at the time and decided that I need many-to-many relationship. Oops, that&rsquo;s not supported. Well, it&rsquo;s &ldquo;kinda&rdquo; supported, meaning you can create a data structure and insert some data, but when you remove the data the foreign key constraints won&rsquo;t be verified and cascade triggers won&rsquo;t work. I think I can simplify the above statement and just call it &ldquo;not supported feature&rdquo;.</p>

<p>Fortunately I didn&rsquo;t absolutely had to use many-to-many relationship. It would be nicer and would allow us to relax some constraints, but the current data could be as well represented using a nested one-to-many relationships. I&rsquo;ve wrote the code based on aforementioned LINQ to SQL tutorial, wrote the tests, run them and watched in amazement as they fail. After googling a lot and experimenting I was able to make my code work, but it was quite different than the crap they posted on MSDN as tutorial. If you want to use LINQ to SQL, take a look at <a href="https://gist.github.com/1682648">this code on github</a>.</p>

<p>I spent about two days reading about LINQ to SQL and experimenting with the code and in the end I didn&rsquo;t even had the data structure I wanted to. And we&rsquo;re not talking here about rocket science, the SQLite scheme I needed was something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">create</span> <span class="k">table</span> <span class="n">x</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span> <span class="nb">text</span> <span class="n">STRING</span><span class="p">);</span>
</span><span class='line'><span class="k">create</span> <span class="k">table</span> <span class="n">y</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span> <span class="nb">text</span> <span class="n">STRING</span><span class="p">);</span>
</span><span class='line'><span class="k">create</span> <span class="k">table</span> <span class="n">z</span> <span class="p">(</span><span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span>
</span><span class='line'>                <span class="n">x_id</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>                <span class="n">y_id</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>                <span class="k">FOREIGN</span> <span class="k">KEY</span><span class="p">(</span><span class="n">x_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">x</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span><span class="p">,</span>
</span><span class='line'>                <span class="k">FOREIGN</span> <span class="k">KEY</span><span class="p">(</span><span class="n">y_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">y</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">CASCADE</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Which leads me to conclusion: LINQ to SQL for Windows Phone just doesn&rsquo;t work. Consider also the amount of boilerplate code I had to write for simple foreign key relation: in case you didn&rsquo;t looked at the github link that&rsquo;s whooping 80 lines of code for every one-to-many relationship. I don&rsquo;t know, maybe there are some tools that generate this stuff for you, but in this case why does the official tutorial even mention writing the table classes by hand? And where are those tools?</p>

<p>Recently I was also playing with Django which also features an ORM for the model definition. You need the foreign key? You use something called <code>ForeignKey</code>. You need the many-to-many relationship? You use the <code>ManyToManyField</code>. Dirt simple. I&rsquo;m sure there are some dark corners you have to be aware of, but the basic stuff just works.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/04/background-operations-on-windows-phone/">Background Operations on Windows Phone 7</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-04T13:23:00+02:00" pubdate data-updated="true">Apr 4<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/04/04/background-operations-on-windows-phone/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/04/04/background-operations-on-windows-phone/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Few weeks ago I was complaining to another developer that Windows Phone applications cannot perform tasks in background when they are not running. That was true few months ago when I learned about Windows Phone 7.0, but he pointed me to MSDN documentation of new WP 7.1 feature: <a href="http://msdn.microsoft.com/en-us/library/hh202961(v=vs.92">Background Agents</a>.aspx).</p>

<p>I clicked the link with my hopes up, but I was immediately shot down with the highlight on the first page: &ldquo;Background agents are not supported on 256-MB devices&rdquo;. I proceeded to the <a href="http://msdn.microsoft.com/en-us/library/hh202942(v=vs.92">overview page</a>.aspx) and it turned out the highlight from the first page was just the tip of the iceberg. The constraints listed there are just staggering.</p>

<p>First there are the registration issues: you can register background task for the next two weeks and after that period your application have to reschedule the task. I&rsquo;m not sure why do I have to do this, and at the first glance it looks only like a minor nuisance, until you take into account two other constraints: tasks cannot reschedule themselves and there is a hard limit of scheduled periodic tasks, which can be ridiculously low. Relevant quote from MSDN:</p>

<blockquote><p>To help maximize the battery life of the device, there is a hard limit on the number of periodic agents that can be scheduled on the phone. It varies per device configuration and can be as low as 6.</p></blockquote>


<p>Not a minor nuisance anymore, huh?</p>

<p>This limit is only imposed on periodic agents, which are intended for short, periodic tasks like polling some service or uploading a data. There are also Resource Intensive Agents which can be used for longer tasks like data synchronization, but they have their own set of constraints: the device have to be charging, the battery have to be almost fully charged and there should be a Wi-Fi or PC connection (no cellular data). I think the MSDN note summarizes it quite well:</p>

<blockquote><p>Due to the constraints on the device that must be met for resource-intensive agents to run, it is possible that the agent will never be run on a particular device. </p><p>(&#8230;)Also, resource-intensive agents are run one at a time, so as more applications that use resource-intensive agents are installed on a device, the likelihood of an agent running becomes even less. You should consider this when designing your application.</p></blockquote>


<p>I&rsquo;m going to add to the comment above my own observation: every application can register only one background agent, which can be both periodic agent and resource intensive agent. It means that if you need both types of agents, your resource intensive agent is also affected by the periodic agent hard limit.</p>

<p>It all boils down to this: <strong>you can&rsquo;t rely on the background agents</strong>. You don&rsquo;t have the guarantee that you&rsquo;ll be able to register the agent, which means that you can&rsquo;t use them for critical functionality. So we&rsquo;re exactly where we were after 7.0 release.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/28/qml-error-handling-revisited/">QML Error Handling Revisited</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-28T23:01:00+02:00" pubdate data-updated="true">Mar 28<span>th</span>, 2012</time>
        
           | <a href="/blog/2012/03/28/qml-error-handling-revisited/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/03/28/qml-error-handling-revisited/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After releasing <a href="http://store.ovi.com/content/219800">Nu, Pogodi!</a> I learned the hard way that checking the QML runtime errors might be a good idea. For that particular application, simply checking the errors from <code>QDeclarativeView</code> after setting the main qml file was enough, because everything in qml file was statically declared. But what if you use <a href="https://qt-project.org/doc/qt-4.8/qml-loader.html">QML Loader</a> element, either explicitly or through some other qml element like <a href="http://doc.qt.nokia.com/qt-components-symbian/qml-pagestack.html">PageStack from Qt Components</a>, and something goes wrong?</p>

<p>Well, if you don&rsquo;t improve the error handling code, your application will silently fail in some places, which probably won&rsquo;t make the users happy. I didn&rsquo;t wanted to repeat the <a href="http://store.ovi.com/content/219800">Nu, Pogodi!</a> screw up when releasing <a href="http://store.ovi.com/content/262535">Word Judge</a>, so I&rsquo;ve created a better error handling solution. First part is an error handler class:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="c1">// ----------------------------------------</span>
</span><span class='line'><span class="c1">//  qmlerrorhandler.h</span>
</span><span class='line'><span class="c1">// ----------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">QmlErrorHandler</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QObject</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">Q_OBJECT</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>    <span class="k">explicit</span> <span class="n">QmlErrorHandler</span><span class="p">(</span><span class="n">QDeclarativeView</span> <span class="o">&amp;</span><span class="n">view</span><span class="p">,</span> <span class="n">QObject</span> <span class="o">*</span><span class="n">parent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="n">errorOccured</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="nl">slots:</span>
</span><span class='line'>    <span class="kt">void</span> <span class="n">handleQmlStatusChange</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">Status</span> <span class="n">status</span><span class="p">);</span>
</span><span class='line'>    <span class="kt">void</span> <span class="n">handleQmlErrors</span><span class="p">(</span><span class="k">const</span> <span class="n">QList</span><span class="o">&lt;</span><span class="n">QDeclarativeError</span><span class="o">&gt;&amp;</span> <span class="n">qmlErrors</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span><span class="o">:</span>
</span><span class='line'>    <span class="n">QDeclarativeView</span> <span class="o">&amp;</span><span class="n">mView</span><span class="p">;</span>
</span><span class='line'>    <span class="kt">bool</span> <span class="n">mErrorOccured</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// ----------------------------------------</span>
</span><span class='line'><span class="c1">//  qmlerrorhandler.cpp</span>
</span><span class='line'><span class="c1">// ----------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="n">QmlErrorHandler</span><span class="o">::</span><span class="n">QmlErrorHandler</span><span class="p">(</span><span class="n">QDeclarativeView</span> <span class="o">&amp;</span><span class="n">view</span><span class="p">,</span> <span class="n">QObject</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="o">:</span>
</span><span class='line'>    <span class="n">QObject</span><span class="p">(</span><span class="n">parent</span><span class="p">),</span>
</span><span class='line'>    <span class="n">mView</span><span class="p">(</span><span class="n">view</span><span class="p">),</span>
</span><span class='line'>    <span class="n">mErrorOccured</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">connect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">view</span><span class="p">,</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">statusChanged</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">Status</span><span class="p">)),</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">handleQmlStatusChange</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">Status</span><span class="p">)));</span>
</span><span class='line'>    <span class="n">connect</span><span class="p">(</span><span class="n">view</span><span class="p">.</span><span class="n">engine</span><span class="p">(),</span> <span class="n">SIGNAL</span><span class="p">(</span><span class="n">warnings</span><span class="p">(</span><span class="n">QList</span><span class="o">&lt;</span><span class="n">QDeclarativeError</span><span class="o">&gt;</span><span class="p">)),</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">handleQmlErrors</span><span class="p">(</span><span class="n">QList</span><span class="o">&lt;</span><span class="n">QDeclarativeError</span><span class="o">&gt;</span><span class="p">)));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="n">QmlErrorHandler</span><span class="o">::</span><span class="n">handleQmlStatusChange</span><span class="p">(</span><span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">Status</span> <span class="n">status</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">QDeclarativeView</span><span class="o">::</span><span class="n">Error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">handleQmlErrors</span><span class="p">(</span><span class="n">mView</span><span class="p">.</span><span class="n">errors</span><span class="p">());</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="n">QmlErrorHandler</span><span class="o">::</span><span class="n">handleQmlErrors</span><span class="p">(</span><span class="k">const</span> <span class="n">QList</span><span class="o">&lt;</span><span class="n">QDeclarativeError</span><span class="o">&gt;&amp;</span> <span class="n">qmlErrors</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">QStringList</span> <span class="n">errors</span><span class="p">;</span>
</span><span class='line'>    <span class="n">foreach</span> <span class="p">(</span><span class="k">const</span> <span class="n">QDeclarativeError</span><span class="o">&amp;</span> <span class="n">error</span><span class="p">,</span> <span class="n">qmlErrors</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Special case for bug in QtComponents 1.1</span>
</span><span class='line'>        <span class="c1">// https://bugreports.qt-project.org/browse/QTCOMPONENTS-1217</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">url</span><span class="p">().</span><span class="n">toString</span><span class="p">().</span><span class="n">endsWith</span><span class="p">(</span><span class="s">&quot;PageStackWindow.qml&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">error</span><span class="p">.</span><span class="n">line</span><span class="p">()</span> <span class="o">==</span> <span class="mi">70</span><span class="p">)</span>
</span><span class='line'>            <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">errors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">toString</span><span class="p">());</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">errors</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span>
</span><span class='line'>        <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">mErrorOccured</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">QMessageBox</span> <span class="n">msgBox</span><span class="p">;</span>
</span><span class='line'>    <span class="n">msgBox</span><span class="p">.</span><span class="n">setText</span><span class="p">(</span><span class="s">&quot;Uh oh, something went terribly wrong!&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">msgBox</span><span class="p">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="s">&quot;We&#39;re sorry, but it seems there are some problems &quot;</span>
</span><span class='line'>                              <span class="s">&quot;with running our application on your phone. Please &quot;</span>
</span><span class='line'>                              <span class="s">&quot;send us the following information to help us resolve &quot;</span>
</span><span class='line'>                              <span class="s">&quot;this issue:</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">+</span>
</span><span class='line'>                              <span class="n">errors</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">));</span>
</span><span class='line'>    <span class="n">msgBox</span><span class="p">.</span><span class="n">exec</span><span class="p">();</span>
</span><span class='line'>    <span class="n">qApp</span><span class="o">-&gt;</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">bool</span> <span class="n">QmlErrorHandler</span><span class="o">::</span><span class="n">errorOccured</span><span class="p">()</span> <span class="k">const</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">mErrorOccured</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And here&rsquo;s how I use it in my applications:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">QScopedPointer</span><span class="o">&lt;</span><span class="n">QApplication</span><span class="o">&gt;</span> <span class="n">app</span><span class="p">(</span><span class="n">createApplication</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">QScopedPointer</span><span class="o">&lt;</span><span class="n">QmlApplicationViewer</span><span class="o">&gt;</span> <span class="n">viewer</span><span class="p">(</span><span class="n">QmlApplicationViewer</span><span class="o">::</span><span class="n">create</span><span class="p">());</span>
</span><span class='line'>    <span class="n">QmlErrorHandler</span> <span class="n">errorHandler</span><span class="p">(</span><span class="o">*</span><span class="n">viewer</span><span class="p">);</span>
</span><span class='line'>    <span class="n">viewer</span><span class="o">-&gt;</span><span class="n">setMainQmlFile</span><span class="p">(</span><span class="n">QLatin1String</span><span class="p">(</span><span class="s">&quot;main.qml&quot;</span><span class="p">));</span>
</span><span class='line'>    <span class="n">viewer</span><span class="o">-&gt;</span><span class="n">showExpanded</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">errorHandler</span><span class="p">.</span><span class="n">errorOccured</span><span class="p">())</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">app</span><span class="o">-&gt;</span><span class="n">exec</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Basically we need to catch the runtime errors, which are emitted from <code>QDeclarativeEngine</code> in signal named for some unfathomable reason <code>warnings</code>. Checking the <code>errorOccured()</code> in <code>main()</code> is ugly, but the <code>qApp-&gt;exit()</code> doesn&rsquo;t work until the event loop in main is started and that&rsquo;s the first thing which came to my mind. Please leave a comment if you know a simpler solution.</p>

<p>Note the lines 46-49 in <code>QmlErrorHandler</code>: we&rsquo;re catching all warnings and the qt components are not completely free of them. I had to add a special case to prevent triggering the handler on every orientation change. If you stumble upon some other errors that should be ignored, please let me know.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/23/word-judge-for-symbian-available-in/">Word Judge for Symbian Available in Nokia Store</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-23T23:23:00+01:00" pubdate data-updated="true">Mar 23<span>rd</span>, 2012</time>
        
           | <a href="/blog/2012/03/23/word-judge-for-symbian-available-in/#disqus_thread"
             data-disqus-identifier="http://chalup.github.io/blog/2012/03/23/word-judge-for-symbian-available-in/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I have finally pushed both versions of Word Judge through Nokia Store QA. The version with an english dictionary was available for over the week now, but I had to submit the polish version few times until it passed the Nokia tests.</p>

<p>Anyways, the applications are available for free in Nokia Store. Here&rsquo;s the link for <a href="http://store.ovi.com/content/262526">english version</a> and <a href="http://store.ovi.com/content/262535">polish version</a> (might not be available in all countries &ndash; I had to add some restrictions to pass QA process).</p>

<p>Stay tuned for posts about development of Symbian version and enjoy your Scrabble games.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/7/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/22/clicking-unclickable-list-items/">Clicking Unclickable List Items</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/10/android-app-widgets-issues/">Android App Widgets Issues</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/25/use-minsdkversion10-for-libraries/">Use minSdkVersion=10 for Libraries</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/20/when-do-you-absolutely-need/">When Do You Absolutely Need WakefulBroadcastReceiver</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/25/offline-mode-in-android-apps-part-3-old/">Offline Mode in Android Apps, Part 3 - Old Db Schemas</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/chalup">@chalup</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'chalup',
            count: 0,
            skip_forks: true,
            filter_repos: [ "microorm", "thneed", "dawggenerator", "cerberus" ],
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/106340839330487061995?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jerzy Chalupski -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'porcupineprogrammer';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
